#Memory-Consistency #Cache-Coherence

- book Link [a_primer_on_memory_consistency_and_cache_coherence_2](https://github.com/kaitoukito/A-Primer-on-Memory-Consistency-and-Cache-Coherence/tree/main)

# 介绍
现代大多数多核处理器都支持硬件共享内存，在共享内存系统中每个处理器核心都可以读写同个共享内存地址，为了在保证正确性的前提下对性能功耗成本进行平衡，在评估和设计正确的共享内存系统需要架构师理解 memory consistency 和 cache coherence


# Consistency
## **memory consistency** 是内存连续性，一般被翻译为内存一致性

## 为什么需要定义共享内存的正确性
硬件实现和程序员期望之间需要契约


## 共享内存的正确性定义
共享内存的由 memory consistency model 或者更加简单的内存模型定义，内存模型是指定使用共享内存执行的多线程程序的允许行为

# Memory consistency model 
[[3. Memory Consistency 动机和 Sequential-Consistency]]

## Sequential Consistency(SC) 顺序连续性


## Total Store Order(TSO)

## relaxed 和 weak 的 Memory Consistency Model


# Cache Coherence
多处理器核心可以通过 Cache 来避免直接访问内存，但 Cache 带来了 Cache  副本和内存的一致性问题，当内存中的数据更改， 副本需要更新防止提供错误的数据。

## Coherence 协议
- Coherence 协议是防止对过时数据的访问的协议
- Coherence 协议虽然又许多变体，但它们都遵循 一些主要原则
	- 本质上这些变体都通过将一个处理器的写入操作传播到所有的缓存中来使得其他的处理器也能看见该写操作，以此来保持数据同步
- 两大分类
	- 同步更新
	- 异步更新

## Cache Coherence 协议的整体架构


## Snooping Cache Coherence（监听缓存一致性/嗅探式缓存一致性）协议

## (Directory Cache Coherence) 目录缓存一致性协议

## Cache Coherence 高级主题



# 异构系统的 Consistency 和 Coherence

# 指定和验证 Memory Consistency Model 和 Cache Coherence

# Consistency 和 Coherence 小测验